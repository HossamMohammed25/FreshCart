import './polyfills.server.mjs';
import{a as I}from"./chunk-V575IDW4.mjs";import{a as O}from"./chunk-GBHRAEDD.mjs";import{a as N,b as d,c as T,d as R,f as q,g as F,h as k,i as w,k as D}from"./chunk-NB7DLP3G.mjs";import{h as x,k as E}from"./chunk-SX4IOAQB.mjs";import"./chunk-EC73D4GI.mjs";import{Db as l,Kb as S,Oa as s,W as p,_ as y,db as _,fb as v,jb as f,nb as o,ob as t,pb as b,ub as C,vb as g}from"./chunk-ZWGHKFBJ.mjs";import"./chunk-VVCT4QZE.mjs";function P(e,n){e&1&&(o(0,"p",12),l(1,"details is required"),t())}function A(e,n){e&1&&(o(0,"p",12),l(1,"must be at least 3 chars"),t())}function B(e,n){if(e&1&&(o(0,"p",4),_(1,P,2,0,"p",12)(2,A,2,0),t()),e&2){let a,r=g();s(),f(1,(a=r.orders.get("details"))!=null&&a.getError("required")?1:(a=r.orders.get("details"))!=null&&a.getError("minlength")?2:-1)}}function G(e,n){e&1&&(o(0,"p",4),l(1,"phone is required"),t())}function M(e,n){e&1&&(o(0,"p",12),l(1,"city is required"),t())}function V(e,n){e&1&&(o(0,"p",12),l(1,"must be at least 3 chars"),t())}function L(e,n){if(e&1&&(o(0,"p",4),_(1,M,2,0,"p",12)(2,V,2,0),t()),e&2){let a,r=g();s(),f(1,(a=r.orders.get("city"))!=null&&a.getError("required")?1:(a=r.orders.get("city"))!=null&&a.getError("minlength")?2:-1)}}var W=(()=>{let n=class n{constructor(){this._FormBuilder=p(w),this._ActivatedRoute=p(x),this._OrdersService=p(I),this._CartService=p(O),this._Router=p(E),this.cartId="",this.orders=this._FormBuilder.group({details:[null,[d.required,d.minLength(3),d.max(30)]],phone:[null,[d.required,d.pattern(/^01[0125][0-9]{8}$/)]],city:[null,[d.required,d.minLength(3),d.max(10)]]})}ngOnInit(){this.activeRouteSub=this._ActivatedRoute.paramMap.subscribe({next:r=>{this.cartId=r.get("id")}})}visaPay(){this._OrdersService.checkout(this.cartId,this.orders.value).subscribe({next:r=>{r.status==="success"&&window.open(r.session.url,"_self")}})}cashPay(){this._OrdersService.cashOrder(this.cartId,this.orders.value).subscribe({next:r=>{this._Router.navigate(["/allorders"]),this._CartService.cartNumber.set(0)}})}ngOnDestroy(){this.activeRouteSub?.unsubscribe(),this.visaSub?.unsubscribe(),this.cashSub?.unsubscribe()}};n.\u0275fac=function(h){return new(h||n)},n.\u0275cmp=y({type:n,selectors:[["app-orders"]],standalone:!0,features:[S],decls:22,vars:6,consts:[[1,"w-75","mx-auto",3,"formGroup"],[1,"my-2"],["for","details"],["id","details","formControlName","details",1,"form-control"],[1,"alert","alert-danger","mt-2"],["for","phone"],["type","tell","formControlName","phone",1,"form-control"],["for","city"],["type","text","formControlName","city",1,"form-control"],[1,"d-flex"],[1,"btn","btn-outline-info","my-4","me-4","w-50",3,"click","disabled"],[1,"btn","btn-outline-info","w-50","my-4",3,"click","disabled"],[1,"m-0"]],template:function(h,i){if(h&1&&(o(0,"section")(1,"form",0)(2,"div",1)(3,"label",2),l(4,"details"),t(),b(5,"textarea",3),_(6,B,3,1,"p",4),t(),o(7,"div",1)(8,"label",5),l(9,"phone"),t(),b(10,"input",6),_(11,G,2,0,"p",4),t(),o(12,"div",1)(13,"label",7),l(14,"city"),t(),b(15,"input",8),_(16,L,3,1,"p",4),t(),o(17,"div",9)(18,"button",10),C("click",function(){return i.visaPay()}),l(19,"Pay Now By Visa"),t(),o(20,"button",11),C("click",function(){return i.cashPay()}),l(21,"Cash"),t()()()()),h&2){let m,u,c;s(),v("formGroup",i.orders),s(5),f(6,(m=i.orders.get("details"))!=null&&m.errors&&((m=i.orders.get("details"))!=null&&m.touched||(m=i.orders.get("details"))!=null&&m.dirty)?6:-1),s(5),f(11,(u=i.orders.get("phone"))!=null&&u.errors&&((u=i.orders.get("phone"))!=null&&u.touched||(u=i.orders.get("phone"))!=null&&u.dirty)?11:-1),s(5),f(16,(c=i.orders.get("city"))!=null&&c.errors&&((c=i.orders.get("city"))!=null&&c.touched||(c=i.orders.get("city"))!=null&&c.dirty)?16:-1),s(2),v("disabled",i.orders.invalid),s(2),v("disabled",i.orders.invalid)}},dependencies:[D,q,N,T,R,F,k]});let e=n;return e})();export{W as OrdersComponent};
